<!DOCTYPE HTML>
<html lang="en" class="ayu" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Getting started - Lesan</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./css/animation-bench.css">
        <link rel="stylesheet" href="./css/styles.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('ayu')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">User Guide</li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="getting_started.html" class="active"><strong aria-hidden="true">2.</strong> Getting started</a></li><li class="chapter-item expanded "><a href="add_relation.html"><strong aria-hidden="true">3.</strong> Add relation</a></li><li class="chapter-item expanded "><a href="add_more_relation.html"><strong aria-hidden="true">4.</strong> Add more relation</a></li><li class="chapter-item expanded "><a href="mannage_relations.html"><strong aria-hidden="true">5.</strong> Mannage relations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="add_relation_fn.html"><strong aria-hidden="true">5.1.</strong> addRelation function</a></li><li class="chapter-item expanded "><a href="remove_relation_fn.html"><strong aria-hidden="true">5.2.</strong> removeRelation function</a></li><li class="chapter-item expanded "><a href="what_is_the_relationship.html"><strong aria-hidden="true">5.3.</strong> What is the relationship really?</a></li></ol></li><li class="chapter-item expanded "><a href="findOne_and_find_fn.html"><strong aria-hidden="true">6.</strong> findOne and find functions</a></li><li class="chapter-item expanded "><a href="aggregation_fn.html"><strong aria-hidden="true">7.</strong> aggregation functions</a></li><li class="chapter-item expanded "><a href="find_one_and_update_functions.html"><strong aria-hidden="true">8.</strong> findOneAndUpdate functions</a></li><li class="chapter-item expanded "><a href="delete_one_fn.html"><strong aria-hidden="true">9.</strong> deleteOne functions</a></li><li class="chapter-item expanded "><a href="insert_many_fn.html"><strong aria-hidden="true">10.</strong> insertMany functions</a></li><li class="chapter-item expanded "><a href="playground.html"><strong aria-hidden="true">11.</strong> Playground</a></li><li class="chapter-item expanded "><a href="request_flow.html"><strong aria-hidden="true">12.</strong> Request flow in Lesan</a></li><li class="chapter-item expanded "><a href="leasan_vs_graphql.html"><strong aria-hidden="true">13.</strong> Lesan vs GraphQL</a></li><li class="chapter-item expanded "><a href="all_advantages_of_lesan.html"><strong aria-hidden="true">14.</strong> All the advantages of Lesan</a></li><li class="chapter-item expanded affix "><li class="part-title">Advanced Guide</li><li class="chapter-item expanded "><a href="an_advanced_project.html"><strong aria-hidden="true">15.</strong> Implement an advanced project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="advanced_general_description.html"><strong aria-hidden="true">15.1.</strong> General description</a></li><li class="chapter-item expanded "><a href="advanced_nx_config.html"><strong aria-hidden="true">15.2.</strong> nx configuration</a></li><li class="chapter-item expanded "><a href="folder_structure.html"><strong aria-hidden="true">15.3.</strong> Folder Structure</a></li><li class="chapter-item expanded "><a href="microservice-monolithic.html"><strong aria-hidden="true">15.4.</strong> Microservice or Monolithic</a></li></ol></li><li class="chapter-item expanded "><a href="manage_replica.html"><strong aria-hidden="true">16.</strong> Manage replica</a></li><li class="chapter-item expanded affix "><li class="part-title">Lesan Philosophy</li><li class="chapter-item expanded "><a href="Receiving_Data.html"><strong aria-hidden="true">17.</strong> Receiving Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Previous_methods_and_the_main_challenge.html"><strong aria-hidden="true">17.1.</strong> Previous methods and the main challenge</a></li><li class="chapter-item expanded "><a href="Lesan's_Solution_For_How_To_Communicate_Between_The_Server_And_The_Client.html"><strong aria-hidden="true">17.2.</strong> Lesan's Solution For How To Communicate Between The Server And The Client</a></li></ol></li><li class="chapter-item expanded "><a href="Why_NoSQL.html"><strong aria-hidden="true">18.</strong> Why noSQL?</a></li><li class="chapter-item expanded "><a href="Queuing_data_changes.html"><strong aria-hidden="true">19.</strong> Queuing data changes</a></li><li class="chapter-item expanded "><a href="CSR_SSR_or_SSG_content.html"><strong aria-hidden="true">20.</strong> CSR, SSR or SSG content</a></li><li class="chapter-item expanded "><a href="Penetration_Into_Depths.html"><strong aria-hidden="true">21.</strong> Penetration Into Depths</a></li><li class="chapter-item expanded "><a href="Microservice.html"><strong aria-hidden="true">22.</strong> Microservice</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Lesan_solution.html"><strong aria-hidden="true">22.1.</strong> Lesan solution</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Structures</li><li class="chapter-item expanded "><a href="Schemas.html"><strong aria-hidden="true">23.</strong> Schemas</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Pure_Structure_In_Schema.html"><strong aria-hidden="true">23.1.</strong> Pure Structure In Schema</a></li></ol></li><li class="chapter-item expanded "><a href="The_InRelation_Structure_In_Schema.html"><strong aria-hidden="true">24.</strong> The InRelation Structure In Schema</a></li><li class="chapter-item expanded "><a href="The_structure_of_OutRelation_in_the_schema.html"><strong aria-hidden="true">25.</strong> The structure of OutRelation in the schema</a></li><li class="chapter-item expanded "><a href="The_structure_of_embed_in_the_schema.html"><strong aria-hidden="true">26.</strong> The structure of embed in the schema</a></li><li class="chapter-item expanded "><a href="The_structure_of_Struct_in_the_schema.html"><strong aria-hidden="true">27.</strong> The structure of Struct in the schema</a></li><li class="chapter-item expanded "><a href="runServer_(web_server_structure).html"><strong aria-hidden="true">28.</strong> runServer (web server structure)</a></li><li class="chapter-item expanded "><a href="Request_processing.html"><strong aria-hidden="true">29.</strong> Request processing</a></li><li class="chapter-item expanded "><a href="Dynamic_structure.html"><strong aria-hidden="true">30.</strong> Dynamic structure</a></li><li class="chapter-item expanded "><a href="Static_structure.html"><strong aria-hidden="true">31.</strong> Static structure</a></li><li class="chapter-item expanded affix "><li class="part-title">API Reference</li><li class="chapter-item expanded "><a href="api/lesan_fn.html"><strong aria-hidden="true">32.</strong> lesan</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/schemas_fn.html"><strong aria-hidden="true">32.1.</strong> schemas</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/schemaFns/schemaFns_fn.html"><strong aria-hidden="true">32.1.1.</strong> schemaFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getSchemas_fn.html"><strong aria-hidden="true">32.1.1.1.</strong> getSchemas</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getPureOfMainRelations_fn.html"><strong aria-hidden="true">32.1.1.2.</strong> getPureOfMainRelations</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getSchema_fn.html"><strong aria-hidden="true">32.1.1.3.</strong> getSchema</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getPureSchema_fn.html"><strong aria-hidden="true">32.1.1.4.</strong> getPureSchema</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getPureFromMainRelations_fn.html"><strong aria-hidden="true">32.1.1.5.</strong> getPureFromMainRelations</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getPureFromRelatedRelations_fn.html"><strong aria-hidden="true">32.1.1.6.</strong> getPureFromRelatedRelations</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/createEmbedded_fn.html"><strong aria-hidden="true">32.1.1.7.</strong> createEmbedded</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/createStruct_fn.html"><strong aria-hidden="true">32.1.1.8.</strong> createStruct</a></li><li class="chapter-item expanded "><a href="api/schemas/schemaFns/getSchemasKeys_fn.html"><strong aria-hidden="true">32.1.1.9.</strong> getSchemasKeys</a></li></ol></li><li class="chapter-item expanded "><a href="api/schemas/mainRelationsFns/mainRelations_Fns.html"><strong aria-hidden="true">32.1.2.</strong> mainRelationsFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/mainRelationsFns/getMainRelations_fn.html"><strong aria-hidden="true">32.1.2.1.</strong> getMainRelations</a></li></ol></li><li class="chapter-item expanded "><a href="api/schemas/relatedRelationFns/relatedRelation_Fns.html"><strong aria-hidden="true">32.1.3.</strong> relatedRelationFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/relatedRelationFns/getRelatedRelations_fn.html"><strong aria-hidden="true">32.1.3.1.</strong> getRelatedRelations</a></li></ol></li><li class="chapter-item expanded "><a href="api/schemas/pureFns/pure_Fns.html"><strong aria-hidden="true">32.1.4.</strong> pureFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/pureFns/addPureModel_Fns.html"><strong aria-hidden="true">32.1.4.1.</strong> addPureModel</a></li><li class="chapter-item expanded "><a href="api/schemas/pureFns/getPureModel_Fns.html"><strong aria-hidden="true">32.1.4.2.</strong> getPureModel</a></li><li class="chapter-item expanded "><a href="api/schemas/pureFns/getPureModelByNameAndKey_Fns.html"><strong aria-hidden="true">32.1.4.3.</strong> getPureModelByNameAndKey</a></li></ol></li><li class="chapter-item expanded "><a href="api/schemas/relationFns/relation_Fns.html"><strong aria-hidden="true">32.1.5.</strong> relationFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/relationFns/getRelation_Fns.html"><strong aria-hidden="true">32.1.5.1.</strong> getRelation</a></li></ol></li><li class="chapter-item expanded "><a href="api/schemas/selectStructFns/selectStructFns_Fns.html"><strong aria-hidden="true">32.1.6.</strong> selectStructFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/schemas/selectStructFns/fieldType_Fn.html"><strong aria-hidden="true">32.1.6.1.</strong> fieldType</a></li><li class="chapter-item expanded "><a href="api/schemas/selectStructFns/decreaseIterate_Fn.html"><strong aria-hidden="true">32.1.6.2.</strong> decreaseIterate</a></li><li class="chapter-item expanded "><a href="api/schemas/selectStructFns/checkRelation_Fn.html"><strong aria-hidden="true">32.1.6.3.</strong> checkRelation</a></li><li class="chapter-item expanded "><a href="api/schemas/selectStructFns/selectStruct_Fn.html"><strong aria-hidden="true">32.1.6.4.</strong> selectStruct</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="api/acts/acts_fn.html"><strong aria-hidden="true">32.2.</strong> acts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/acts/setAct/setAct_Fns.html"><strong aria-hidden="true">32.2.1.</strong> setAct</a></li><li class="chapter-item expanded "><a href="api/acts/getServiceKeys/getServiceKeys_Fns.html"><strong aria-hidden="true">32.2.2.</strong> getServiceKeys</a></li><li class="chapter-item expanded "><a href="api/acts/getActs/getActs_Fns.html"><strong aria-hidden="true">32.2.3.</strong> getActs</a></li><li class="chapter-item expanded "><a href="api/acts/getActsKeys/getActsKeys_Fns.html"><strong aria-hidden="true">32.2.4.</strong> getActsKeys</a></li><li class="chapter-item expanded "><a href="api/acts/getActKeys/getActKeys_Fns.html"><strong aria-hidden="true">32.2.5.</strong> getActKeys</a></li><li class="chapter-item expanded "><a href="api/acts/getAct/getAct_Fns.html"><strong aria-hidden="true">32.2.6.</strong> getAct</a></li><li class="chapter-item expanded "><a href="api/acts/getAtcsWithServices/getAtcsWithServices_Fns.html"><strong aria-hidden="true">32.2.7.</strong> getAtcsWithServices</a></li><li class="chapter-item expanded "><a href="api/acts/getMainActs/getMainActs_Fns.html"><strong aria-hidden="true">32.2.8.</strong> getMainActs</a></li><li class="chapter-item expanded "><a href="api/acts/getMainAct/getMainAct_Fns.html"><strong aria-hidden="true">32.2.9.</strong> getMainAct</a></li><li class="chapter-item expanded "><a href="api/acts/setService/setService_Fns.html"><strong aria-hidden="true">32.2.10.</strong> setService</a></li><li class="chapter-item expanded "><a href="api/acts/getService/getService_Fns.html"><strong aria-hidden="true">32.2.11.</strong>   getService</a></li></ol></li><li class="chapter-item expanded "><a href="api/odm/odm_fn.html"><strong aria-hidden="true">32.3.</strong> odm</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/odm/setDb/setDb_Fns.html"><strong aria-hidden="true">32.3.1.</strong> setDb</a></li><li class="chapter-item expanded "><a href="api/odm/getCollection/getCollection_Fns.html"><strong aria-hidden="true">32.3.2.</strong> getCollection</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/newModel_Fns.html"><strong aria-hidden="true">32.3.3.</strong> newModel</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/odm/newModel/find_Fns.html"><strong aria-hidden="true">32.3.3.1.</strong> find</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/findOne_Fns.html"><strong aria-hidden="true">32.3.3.2.</strong> findOne</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/insertOne_Fns.html"><strong aria-hidden="true">32.3.3.3.</strong> insertOne</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/insertMany_Fns.html"><strong aria-hidden="true">32.3.3.4.</strong> insertMany</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/addRelation_Fns.html"><strong aria-hidden="true">32.3.3.5.</strong> addRelation</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/removeRelation_Fns.html"><strong aria-hidden="true">32.3.3.6.</strong> removeRelation</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/findOneAndUpdate_Fns.html"><strong aria-hidden="true">32.3.3.7.</strong> findOneAndUpdate</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/deleteOne_Fns.html"><strong aria-hidden="true">32.3.3.8.</strong> deleteOne</a></li><li class="chapter-item expanded "><a href="api/odm/newModel/aggregation_Fns.html"><strong aria-hidden="true">32.3.3.9.</strong> aggregation</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="api/context/contextFns_fn.html"><strong aria-hidden="true">32.4.</strong> contextFns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/context/getContextModel/getContextModel_Fns.html"><strong aria-hidden="true">32.4.1.</strong> getContextModel</a></li><li class="chapter-item expanded "><a href="api/context/setContext/setContext_Fns.html"><strong aria-hidden="true">32.4.2.</strong> setContext</a></li><li class="chapter-item expanded "><a href="api/context/getContextModel/addContext_Fns.html"><strong aria-hidden="true">32.4.3.</strong> addContext</a></li><li class="chapter-item expanded "><a href="api/context/getContextModel/addContexts_Fns.html"><strong aria-hidden="true">32.4.4.</strong> addContexts</a></li><li class="chapter-item expanded "><a href="api/context/getContextModel/addReqToContext_Fns.html"><strong aria-hidden="true">32.4.5.</strong> addReqToContext</a></li><li class="chapter-item expanded "><a href="api/context/getContextModel/addHeaderToContext_Fns.html"><strong aria-hidden="true">32.4.6.</strong> addHeaderToContext</a></li><li class="chapter-item expanded "><a href="api/context/getContextModel/addBodyToContext_Fns.html"><strong aria-hidden="true">32.4.7.</strong> addBodyToContext</a></li></ol></li><li class="chapter-item expanded "><a href="api/runServer/runServer_fn.html"><strong aria-hidden="true">32.5.</strong> runServer</a></li><li class="chapter-item expanded "><a href="api/generateSchema/generateSchemTypes_fn.html"><strong aria-hidden="true">32.6.</strong> generateSchemTypes</a></li></ol></li><li class="chapter-item expanded "><a href="api/types/types.html"><strong aria-hidden="true">33.</strong> types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/schema/Tschemas.html"><strong aria-hidden="true">33.1.</strong> Tshemas types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/schema/IModel.html"><strong aria-hidden="true">33.1.1.</strong> IModel types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/schema/model/TRelation.html"><strong aria-hidden="true">33.1.1.1.</strong> TRelation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/schema/model/TRelation/RelationDataType.html"><strong aria-hidden="true">33.1.1.1.1.</strong> RelationDataType</a></li><li class="chapter-item expanded "><a href="api/types/schema/model/TRelation/RelationSortOrderType.html"><strong aria-hidden="true">33.1.1.1.2.</strong> RelationSortOrderType</a></li><li class="chapter-item expanded "><a href="api/types/schema/model/TRelation/TRelatedRelation.html"><strong aria-hidden="true">33.1.1.1.3.</strong> TRelatedRelation</a></li></ol></li><li class="chapter-item expanded "><a href="api/types/schema/model/IMainRelation.html"><strong aria-hidden="true">33.1.1.2.</strong> IMainRelation</a></li><li class="chapter-item expanded "><a href="api/types/schema/model/IRelatedRelation.html"><strong aria-hidden="true">33.1.1.3.</strong> IRelatedRelation</a></li></ol></li><li class="chapter-item expanded "><a href="api/types/schema/RelationType.html"><strong aria-hidden="true">33.1.2.</strong> RelationType</a></li><li class="chapter-item expanded "><a href="api/types/schema/IPureFields.html"><strong aria-hidden="true">33.1.3.</strong> IPureFields</a></li><li class="chapter-item expanded "><a href="api/types/schema/CheckRelation.html"><strong aria-hidden="true">33.1.4.</strong> CheckRelation</a></li><li class="chapter-item expanded "><a href="api/types/schema/Iterate.html"><strong aria-hidden="true">33.1.5.</strong> Iterate</a></li></ol></li><li class="chapter-item expanded "><a href="api/types/Services/Services.html"><strong aria-hidden="true">33.2.</strong> Services types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/Services/Acts.html"><strong aria-hidden="true">33.2.1.</strong> Acts types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/Services/Acts/Act.html"><strong aria-hidden="true">33.2.1.1.</strong> Act</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/Services/Acts/Act/ActFn.html"><strong aria-hidden="true">33.2.1.1.1.</strong> ActFn</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/Services/Acts/Act/ActFn/TLesanBody.html"><strong aria-hidden="true">33.2.1.1.1.1.</strong> TLesanBody</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/Services/Acts/Act/ActFn/TLesanBody/Details.html"><strong aria-hidden="true">33.2.1.1.1.1.1.</strong> Details</a></li></ol></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="api/types/Services/ActInp.html"><strong aria-hidden="true">33.2.2.</strong> ActInp</a></li></ol></li><li class="chapter-item expanded "><a href="api/types/odm.html"><strong aria-hidden="true">33.3.</strong> odm types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/TInsertRelations.html"><strong aria-hidden="true">33.3.1.</strong> TInsertRelations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/TInsertRelations/IRelationsFileds.html"><strong aria-hidden="true">33.3.1.1.</strong> IRelationsFileds</a></li></ol></li><li class="chapter-item expanded "><a href="api/types/aggregation/projection/projection.html"><strong aria-hidden="true">33.3.2.</strong> projection</a></li></ol></li><li class="chapter-item expanded "><a href="api/types/context.html"><strong aria-hidden="true">33.4.</strong> context types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/types/context/LesanContenxt.html"><strong aria-hidden="true">33.4.1.</strong> LesanContenxt</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Lesan</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/MiaadTeam/lesan" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/MiaadTeam/lesan/tree/main/pages/src/getting_started.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="getting-started"><a class="header" href="#getting-started">Getting started</a></h1>
<p>I copy this simple example from <a href="./installation.html">installation</a> page. We will keep this file as <code>mod.ts</code> and continue to add various models and functions to it.</p>
<pre><code class="language-ts">import { lesan, MongoClient } from &quot;https://deno.land/x/lesan@vx.x.x/mod.ts&quot;; // Please replace `x.x.x` with the latest version in [releases](https://github.com/MiaadTeam/lesan/releases)

const coreApp = lesan();

const client = await new MongoClient(&quot;mongodb://127.0.0.1:27017/&quot;).connect();

const db = client.db(&quot;dbName&quot;); // change dbName to the appropriate name for your project.

coreApp.odm.setDb(db);

coreApp.runServer({ port: 1366, typeGeneration: false, playground: true });
</code></pre>
<blockquote>
<p>Please replace <code>x.x.x</code> in the import link with the latest version in <a href="https://github.com/MiaadTeam/lesan/releases">releases</a></p>
</blockquote>
<h2 id="add-new-model"><a class="header" href="#add-new-model">Add New Model</a></h2>
<p>For adding a new model we should call <code>newModel</code> function from <code>coreApp.odm</code>. Lets add a country model, please add the following code before <code>coreApp.runServer</code>:</p>
<pre><code class="language-ts">const countryPure = {
  name: string(),
  population: number(),
  abb: string(),
};

const countryRelations = {};

const countries = coreApp.odm.newModel(
  &quot;country&quot;,
  countryPure,
  countryRelations
);
</code></pre>
<blockquote>
<p>We also need to import <code>string</code> and <code>number</code> from lesan. These are validators exported from <a href="https://github.com/ianstormtaylor/superstruct">Superstruct</a>. We use Superstruct to define models and validate function inputs and some other things.</p>
</blockquote>
<p>The <code>newModel</code> function accepts three inputs:</p>
<ul>
<li>The first input is to define the name of the new model.</li>
<li>The second input is to define the pure fields of that model in the database. For this, we use an object whose keys are the names of each of the fields, and the value of these keys is obtained by one of the functions exported from <a href="https://github.com/ianstormtaylor/superstruct">Superstruct</a>.</li>
<li>The third input is to define the relationship between models. Because we have just one model here, we pass an empty object for that. We will read more about this later.</li>
</ul>
<p>Finally, the <code>newModel</code> function returns an object that has services such as <code>insertOne</code>, <code>insertMany</code>, <code>updateOne</code>, <code>deleteOne</code>, and so on.</p>
<h2 id="add-an-access-point"><a class="header" href="#add-an-access-point">Add an access point</a></h2>
<p>Every model needs at least one <code>act</code> as an access point to communicate and send or receive data. For adding an <code>act</code> to <code>countries</code> please add the following code before <code>coreApp.runServer</code>:</p>
<pre><code class="language-ts">const addCountryValidator = () =&gt; {
  return object({
    set: object(countryPure),
    get: coreApp.schemas.selectStruct(&quot;country&quot;, 1),
  });
};

const addCountry: ActFn = async (body) =&gt; {
  const { name, population, abb } = body.details.set;
  return await countries.insertOne({
    doc: {
      name,
      population,
      abb,
    },
    projection: body.details.get,
  });
};

coreApp.acts.setAct({
  schema: &quot;country&quot;,
  actName: &quot;addCountry&quot;,
  validator: addCountryValidator(),
  fn: addCountry,
});
</code></pre>
<blockquote>
<p>We need to import <code>object</code> function <code>ActFn</code> type from <code>lesan</code></p>
</blockquote>
<h3 id="the-setact-function"><a class="header" href="#the-setact-function">The <code>setAct</code> function</a></h3>
<p>As you can see, to add an act to <code>country</code>, we need to use the <code>setAct</code> function in <code>coreApp.acts</code>.
This function receives an object as input that has the following keys:</p>
<ul>
<li><code>schema</code> is the name of the model to which we want to set an action.</li>
<li><code>actName</code> is just a simple string to identify the act.</li>
<li><code>fn</code> is the function we call when a request arrives for it.</li>
<li><code>validator</code> is a superstruct object which is called before calling the act fn and validating the given data. Validator includes <code>set</code> and <code>get</code> objects.</li>
<li>An optional key named <code>validationRunType</code> that receives the values of <code>assert</code> and <code>create</code> and determines the type of validator run so that we can create data or change previous data during validation. You can read about it <a href="https://docs.superstructjs.org/guides/03-coercing-data">here</a>.</li>
<li>There is another optional key called <code>preAct</code> which receives an array of functions. These functions are executed in the order of the array index before the execution of the main endpoint function. With these functions, we can store information in the context and use it in the main function, or not allow the main function to be executed. We mostly use this key for <code>authorization</code> and <code>authentication</code>. You can think of that key as middleware in Express.</li>
<li>Like <code>preAct</code>, there is another optional key called <code>preValidation</code>. which, like <code>preAct</code>, receives an array of functions and executes them in order before executing the validation function.</li>
</ul>
<p>There is a <code>context</code> inside Lesan, which is available by <code>contextFns.getContextModel()</code> function. And we can share information between the functions of an <code>Act</code> like <code>preAct</code>, <code>preValidation</code>, <code>validator</code> and <code>fn</code> through this context. By default, the <code>body</code> and <code>header</code> of each request are available in this context.</p>
<p>In addition, the <code>fn</code> function receives an input called <code>body</code>, which is the <code>body</code> of the sent request. If we have changed the body in the <code>context</code>. The body entered in <code>fn</code> function will be updated and changed.</p>
<h3 id="the-validator-function"><a class="header" href="#the-validator-function">The Validator function</a></h3>
<p>In the <code>addCountryValidator</code> function that we wrote for the <code>validator</code> key, we have returned the <code>object</code> function from the Superstruct struct.<br />
This <code>object</code> contains two key:</p>
<ul>
<li><code>set</code>: It is an <code>object</code> in which we define the required input information for each function available on the client side. In the desired function, we can get the <code>set</code> object information from this address. <code>body.details.set</code>. Note that this object must be of Superstruct <code>object</code> function type.</li>
<li><code>get</code>: This key is also a Superstruct <code>object</code>, where we specify what data can be sent to the client. This object is used in such a way that the client can specify what data he needs with values of <code>0</code> or <code>1</code> for each <code>key</code>. Actually, this object can be like this:
<pre><code class="language-ts">get: object({
  name: enums([0, 1]),
  population: enums([0, 1]),
  abb: enums([0, 1]),
});
</code></pre>
But as you can see, we have used <code>selectStruct</code> function of <code>coreApp.schemas.selectStruct</code>. This function has two inputs. The first input is the <code>name</code> of the model for which we want to generate this object, and the second input specifies the degree of penetration into each <code>relationship</code>. The second input of the <code>selectStruct</code> function can be entered as a <code>number</code> or an <code>object</code>. If entered as an object, the keys of this object must be the <code>names</code> of the selected model relationships, and its value can again be a <code>number</code> or an <code>object</code> of its key relationships. Such as:
<pre><code class="language-ts">  get: coreApp.schemas.selectStruct(&quot;country&quot;, {
      provinces: {
        cities: 1
      },
      createdBy: 2,
      users:{
        posts: 1
      }
    }),
</code></pre>
As a result, an object will be produced as follows:
<pre><code class="language-ts">get: object({
  name: enums([0, 1]),
  population: enums([0, 1]),
  abb: enums([0, 1]),
  provinces: object({
    name: enums([0, 1]),
    population: enums([0, 1]),
    abb: enums([0, 1]),
    cities: object({
      name: enums([0, 1]),
      population: enums([0, 1]),
      abb: enums([0, 1]),
    }),
  }),
  createdBy: object({
    name: enums([0, 1]),
    family: enums([0, 1]),
    email: enums([0, 1]),
    livedCity: object({
      name: enums([0, 1]),
      population: enums([0, 1]),
      abb: enums([0, 1]),
      province: object({
        name: enums([0, 1]),
        population: enums([0, 1]),
        abb: enums([0, 1]),
      }),
    }),
    posts: object({
      title: enums([0, 1]),
      description: enums([0, 1]),
      photo: enums([0, 1]),
      auther: object({
        name: enums([0, 1]),
        family: enums([0, 1]),
        email: enums([0, 1]),
      }),
    }),
  }),
  users: object({
    name: enums([0, 1]),
    family: enums([0, 1]),
    email: enums([0, 1]),
    post: object({
      title: enums([0, 1]),
      description: enums([0, 1]),
      photo: enums([0, 1]),
    }),
  }),
});
</code></pre>
We directly send the data received from the get key as a projection to MongoDB.</li>
</ul>
<h3 id="the-fn-function"><a class="header" href="#the-fn-function">The <code>fn</code> function</a></h3>
<p>The <code>fn</code> key receives the main <code>act</code> function, we write this function for that:</p>
<pre><code class="language-ts">const addCountry: ActFn = async (body) =&gt; {
  const { name, population, abb } = body.details.set;
  return await countries.insertOne({
    doc: {
      name,
      population,
      abb,
    },
    projection: body.details.get,
  });
};
</code></pre>
<p>This function receives an input called <code>body</code>, the <code>body</code> of the <code>request</code> sent from the client side is passed to it when this function is called, as a result, we have access to the information sent by users.
The request body sent from the client side should be a <code>JSON</code> like this:</p>
<pre><code class="language-JSON">{
  &quot;service&quot;: &quot;main&quot;,
  &quot;model&quot;: &quot;country&quot;,
  &quot;act&quot;: &quot;addCountry&quot;,
  &quot;details&quot;: {
    &quot;set&quot;: {
      &quot;name&quot;: &quot;Iran&quot;,
      &quot;population&quot;: 85000000,
      &quot;abb&quot;: &quot;IR&quot;
    },
    &quot;get&quot;: {
      &quot;_id&quot;: 1,
      &quot;name&quot;: 1,
      &quot;population&quot;: 1,
      &quot;abb&quot;: 1
    }
  }
}
</code></pre>
<ul>
<li>The <code>service</code> key is used to select one of the <code>microservices</code> set on the application. You can read more about this here.</li>
<li>The <code>model</code> key is used to select one of the <code>Models</code> added to the application.</li>
<li>The <code>act</code> key is used to select one of the <code>Acts</code> added to the application.</li>
<li>The <code>details</code> key is used to receive data to be sent from the client side along with data to be delivered to users. This key has two internal keys called <code>get</code> and <code>set</code>, we talked a little about it before.
<ul>
<li><code>set</code>: It contains the information we need in the <code>Act</code> function. For this reason, we can extract <code>name</code>, <code>population</code>, and <code>abb</code> from within <code>body.details.set</code>.</li>
<li><code>get</code>: Contains selected information that the user needs to be returned. Therefore, we can pass this object directly to Mongo <code>projection</code>.</li>
</ul>
</li>
</ul>
<p>As you can see, we have used the <code>insertOne</code> function, which was exported from the <code>countries</code> model, to add a new document. This function accepts an object as input, which has the following keys:</p>
<pre><code class="language-ts">{
  doc: OptionalUnlessRequiredId&lt;InferPureFieldsType&gt;;
  relations?: TInsertRelations&lt;TR&gt;;
  options?: InsertOptions;
  projection?: Projection;
}
</code></pre>
<ul>
<li>The <code>doc</code> key receives an object of the pure values of the selected model. <code>OptionalUnlessRequiredId</code> type is the <code>document</code> type in the official MongoDB driver. You can read about it <a href="https://mongodb.github.io/node-mongodb-native/6.1/types/OptionalUnlessRequiredId.html">here</a>.</li>
<li>The <code>relations</code> key receives an object from the relations of this model. There is no relationship here. We will read about this in the next section.</li>
<li>The <code>options</code> key gets the official MongoDB driver options to insertOne. You can read more about this <a href="https://mongodb.github.io/node-mongodb-native/3.6/api/Collection.html#insertOne">here</a></li>
<li>The <code>projection</code> key is used to receive written data. We use native projection in MangoDB. You can read MongoDB's own documentation <a href="https://www.mongodb.com/docs/manual/tutorial/project-fields-from-query-results/">here</a>. In <code>insertOne</code>, you can only penetrate one step in relationships. Here you can get only pure fields because there is no relation. We will read more about this later.</li>
</ul>
<h2 id="the-code"><a class="header" href="#the-code">The code</a></h2>
<p>So this is all the code we've written so far (You can also see and download this code from <a href="https://raw.githubusercontent.com/MiaadTeam/lesan/main/examples/document/02-impement-first-fn.ts">here</a>):</p>
<pre><code class="language-ts">import {
  ActFn,
  lesan,
  MongoClient,
  number,
  object,
  string,
} from &quot;https://deno.land/x/lesan@vx.x.x/mod.ts&quot;; // Please replace `x.x.x` with the latest version in [releases](https://github.com/MiaadTeam/lesan/releases)

const coreApp = lesan();

const client = await new MongoClient(&quot;mongodb://127.0.0.1:27017/&quot;).connect();

const db = client.db(&quot;dbName&quot;); // change dbName to the appropriate name for your project.

coreApp.odm.setDb(db);

const countryPure = {
  name: string(),
  population: number(),
  abb: string(),
};

const countryRelations = {};

const countries = coreApp.odm.newModel(
  &quot;country&quot;,
  countryPure,
  countryRelations
);

const addCountryValidator = () =&gt; {
  return object({
    set: object(countryPure),
    get: coreApp.schemas.selectStruct(&quot;country&quot;, { users: 1 }),
  });
};

const addCountry: ActFn = async (body) =&gt; {
  const { name, population, abb } = body.details.set;
  return await countries.insertOne({
    doc: {
      name,
      population,
      abb,
    },
    projection: body.details.get,
  });
};

coreApp.acts.setAct({
  schema: &quot;country&quot;,
  actName: &quot;addCountry&quot;,
  validator: addCountryValidator(),
  fn: addCountry,
});

coreApp.runServer({ port: 1366, typeGeneration: false, playground: true });
</code></pre>
<blockquote>
<p>Please replace <code>x.x.x</code> in the import link with the latest version in <a href="https://github.com/MiaadTeam/lesan/releases">releases</a></p>
</blockquote>
<h3 id="run-server-function"><a class="header" href="#run-server-function">Run Server function</a></h3>
<p>The last thing we want to talk about is the <code>coreApp.runServer</code> function, this function receives an <code>object</code> input that has the following keys:</p>
<ul>
<li><code>port</code> used to specify the port used to run the server.</li>
<li><code>polyground</code> that receives a <code>Boolean</code> value that specifies whether the Polyground is available at <code>http://{server-address}:{port}/playground</code> address.</li>
<li><code>typeGeneration</code>, which receives a <code>Boolean</code> value and creates a folder named <code>declarations</code>, and inside it, the typefaces of the program are generated to be used in various cases, we will read more about this later.</li>
<li><code>staticPath</code> that receives an <code>array</code> of paths as a <code>string</code> and makes the content inside these paths statically serveable. We will read more about this later.</li>
<li><code>cors</code> which receives either the <code>*</code> value or an <code>array</code> of URLs as a <code>string</code>, and makes these addresses have the ability to communicate with the server and not receive the <code>cors</code> error.</li>
</ul>
<h3 id="running-app"><a class="header" href="#running-app">Running App</a></h3>
<blockquote>
<p>Now you can run <code>deno run -A mod.ts</code> for running the Application with deno</p>
</blockquote>
<p>You can use playground:
<img width="1680" alt="Screen Shot 1402-07-30 at 11 17 19" src="https://github.com/MiaadTeam/lesan/assets/6236123/1e514e6c-58b3-484b-ae73-e6cc8e26c56c">
Or postman:
<img width="1643" alt="Screen Shot 1402-07-30 at 11 35 40" src="https://github.com/MiaadTeam/lesan/assets/6236123/1c9e0d4a-c875-4b14-9832-8d7c680ebe18"></p>
<p>To send a <code>post</code> request to <code>http://localhost:1366/lesan</code> with this <code>request body</code>:</p>
<pre><code class="language-JSON">{
  &quot;service&quot;: &quot;main&quot;,
  &quot;model&quot;: &quot;country&quot;,
  &quot;act&quot;: &quot;addCountry&quot;,
  &quot;details&quot;: {
    &quot;set&quot;: {
      &quot;name&quot;: &quot;Iran&quot;,
      &quot;population&quot;: 85000000,
      &quot;abb&quot;: &quot;IR&quot;
    },
    &quot;get&quot;: {
      &quot;_id&quot;: 1,
      &quot;name&quot;: 1,
      &quot;population&quot;: 1,
      &quot;abb&quot;: 1
    }
  }
}
</code></pre>
<p>For inserting a new country.</p>
<p>You shuold get this result:</p>
<pre><code class="language-JSON">{
  &quot;body&quot;: {
    &quot;_id&quot;: &quot;6534d7c6c5dec0be8e7bf751&quot;,
    &quot;name&quot;: &quot;Iran&quot;,
    &quot;population&quot;: 85000000,
    &quot;abb&quot;: &quot;IR&quot;
  },
  &quot;success&quot;: true
}
</code></pre>
<h3 id="add-e2e-test"><a class="header" href="#add-e2e-test">Add E2E Test</a></h3>
<p>For adding <code>addCountry</code> request to E2E section you should click on the <strong>E2E button</strong>, like below picture.</p>
<img width="1680" alt="e2e sequence" src="https://github.com/MiaadTeam/lesan/assets/96171913/fae58c10-f792-4041-89ca-186dc89bcee1">
<p>Then, when you go to the <strong>E2E section</strong>, you can see 2 sequense that first one is the default sequence that you should delete that.
so, you have one sequence that include your request information(like bottom picture).</p>
<img alt="e2e sequence" src="https://github.com/MiaadTeam/lesan/assets/96171913/e56cfaea-5a7c-4aab-ab7f-4c215e875fb6">

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="installation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="add_relation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="installation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="add_relation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
